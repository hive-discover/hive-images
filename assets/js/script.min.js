function readURL(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){$("#imageResult").attr("src",e.target.result)},t.readAsDataURL(e.files[0])}}!function(e){"use strict";e('a.js-scroll-trigger[href*="#"]:not([href="#"])').click((function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var t=e(this.hash);if((t=t.length?t:e("[name="+this.hash.slice(1)+"]")).length)return e("html, body").animate({scrollTop:t.offset().top-70},1e3,"easeInOutExpo"),!1}})),e(document).scroll((function(){e(this).scrollTop()>100?e(".scroll-to-top").fadeIn():e(".scroll-to-top").fadeOut()})),e(".js-scroll-trigger").click((function(){e(".navbar-collapse").collapse("hide")})),e("body").scrollspy({target:"#mainNav",offset:80});var t=function(){e("#mainNav").offset().top>100?e("#mainNav").addClass("navbar-shrink"):e("#mainNav").removeClass("navbar-shrink")};t(),e(window).scroll(t),e((function(){e("body").on("input propertychange",".floating-label-form-group",(function(t){e(this).toggleClass("floating-label-form-group-with-value",!!e(t.target).val())})).on("focus",".floating-label-form-group",(function(){e(this).addClass("floating-label-form-group-with-focus")})).on("blur",".floating-label-form-group",(function(){e(this).removeClass("floating-label-form-group-with-focus")}))}))}(jQuery),$((function(){$("#upload").on("change",(function(){readURL(input)}))}));var input=document.getElementById("upload"),infoArea=document.getElementById("upload-label");function showFileName(e){var t=e.srcElement.files[0].name;infoArea.textContent="File name: "+t}input.addEventListener("change",showFileName);const API_ADDRESS="https://api.hive-discover.tech/v1/",blocked_urls=["https://files.peakd.com/file/peakd-hive/ridor5301/245cyhmmwFDnV4yecfPyUyx3YJv9iNwTkpUXajj584WdwFtdRGyQL7dc55JnJ4a67UQRH.jpg","https://images.hive.blog/DQmNWT3pij1jZRAH8cdLathMLxkAeCBYESj8oKscYS786jW/Line HIve.png","https://images.hive.blog/DQmWNkFtbpcrjeLjgQhCGCJPJ8fxnZdJ2jjZyAxDYW5zLsg/IMG_20210920_155748.jpg"];$().ready(()=>{$("#btn_search_topics").click(OnClick_SearchByTopic),$("#btn_search_img_url").click(OnClick_SearchByURL),$("#btn_search_uploaded").click(OnClick_SearchByIMG);const e=new URLSearchParams(window.location.search);e.get("q")&&($("#txt_search_topics").val(e.get("q")),$("#btn_search_topics").click())});let all_images={},modal_images=[];const clearSearch=()=>{all_images={},$("#container-search-results").empty(),document.getElementById("section-search-results").style.display="block",document.getElementById("label-no-results").style.display="none",document.getElementById("search-loading-spinner").style.display="block"},expandImage=async(e,t,a)=>{document.getElementById("expand-image-url").src=e,document.getElementById("expand-image-label-url").value=e,document.getElementById("exand-image-permlink").value=a,document.getElementById("exand-image-author").value="@"+t,$("#image-expand").modal("show")},showImageModal=async e=>{const t=all_images[e];modal_images=[],$("#modal-title").text('"'+t.title+'"'),$("#modal-author").text("by @"+t.author),document.getElementById("container-post-images").innerHTML="",document.getElementById("modal-loader").style.display="block",$("#image-modal").modal("show");for(let e=0;e<t.imgs.length;e++){const a=`\n        <div class="col-md-6 col-lg-4" style="margin: auto">\n            <a class="d-block mx-auto portfolio-item" href="javascript:expandImage('${t.imgs[e]}', '${t.author}', '${t.permlink}');">\n                <div class="d-flex portfolio-item-caption position-absolute h-100 w-100">\n                    <div class="text-center text-white my-auto portfolio-item-caption-content w-100">\n                        <i class="fa fa-expand"></i>\n                    </div>\n                </div>\n                <img class="img-fluid" src="${t.imgs[e]}" loading="lazy" />\n                </div>\n            </a>\n        </div>\n        `;modal_images.push(t.imgs[e]),$("#container-post-images").append(a)}document.getElementById("modal-loader").style.display="none"},addOneImage=async(e,t="container-search-results")=>{const a=`\n        <div class="col-md-6 col-lg-4">\n            <a class="d-block mx-auto portfolio-item" href="javascript:showImageModal('${e}');">\n                <div class="d-flex portfolio-item-caption position-absolute h-100 w-100">\n                    <div class="text-center text-white my-auto portfolio-item-caption-content w-100">\n                        <i class="fa fa-search-plus fa-3x"></i>\n                    </div>\n                </div>\n                <img class="img-fluid" src="${e}" loading="lazy" />\n                <p style="float: right;">by <small>@${all_images[e].author}</small></p>\n            </a>\n        </div>\n    `;$("#"+t).append(a)},addOnePost=async(e,t="container-search-results")=>{let a=e.json_metadata.image;e.json_metadata.thumbnails&&(a=e.json_metadata.thumbnails),all_images[a[0]]={author:e.author,permlink:e.permlink,title:e.title,tags:e.json_metadata.tags,imgs:a.filter(e=>!blocked_urls.includes(e))},await addOneImage(a[0],t)},loadResults=async(e,t=15)=>{for(let a=0;e.posts.length,a<t;a++)await addOnePost(e.posts.shift());document.getElementById("search-loading-spinner").style.display="none",document.getElementById("btn-load-more-images").style.display="block",$("#btn-load-more-images").click(async()=>{document.getElementById("btn-load-more-images").style.display="none",document.getElementById("search-loading-spinner").style.display="block";for(let a=0;e.posts.length,a<t;a++)await addOnePost(e.posts.shift());e.posts.length>0&&(document.getElementById("btn-load-more-images").style.display="block"),document.getElementById("search-loading-spinner").style.display="none"})},getTextSearchAPIData=(e,t=100)=>{const a={query:e,lang:"en",amount:t,index_name:"stock.images-index",full_data:!0};return new Promise((e,t)=>{$.ajax({url:API_ADDRESS+"search/posts",contentType:"application/json;charset=UTF-8",method:"POST",data:JSON.stringify(a),success:function(t){e(t)},error:function(e){t(e)}})})},getSimilarURLSearchAPIData=async()=>{const e=$("#txt_search_img_url").val();$.ajax({url:"http://127.0.0.1:3838/url?img_url="+e,contentType:"application/json;charset=UTF-8",method:"POST",success:function(e){console.log(e)},error:function(e){console.error(e)}})},OnClick_SearchByIMG=async()=>{form=new FormData,form.append("file",document.getElementById("upload").files[0]);let e=await fetch("http://127.0.0.1:3838/img",{method:"POST",body:form}),t=await e.json();console.log(t)},OnClick_SearchByTopic=async()=>{const e=$("#txt_search_topics").val();if(0==e.length)return void(document.getElementById("label-no-results").style.display="block");clearSearch();const t=await getTextSearchAPIData(e).catch(e=>{});if(console.log(t),void 0===t||"ok"!==t.status||void 0===t.posts)return document.getElementById("label-no-results").style.display="block",document.getElementById("search-loading-spinner").style.display="none",void $("#modal-something-went-wrong").modal("show");t.posts.length>0&&(document.getElementById("label-no-results").style.display="none"),loadResults(t)},OnClick_SearchByURL=async()=>{const e=$("#txt_search_img_url").val();if(0==e.length)return document.getElementById("label-no-results").style.display="block",void alert("Please enter a topic");document.getElementById("img_search_url").src=e,document.getElementById("section-search-results").style.display="block",document.getElementById("label-no-results").style.display="none",document.getElementById("search-loading-spinner").style.display="block",clearSearch()};